<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GPA Calculator</title>
    <link rel="stylesheet" href="styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Readex+Pro:wght@300;400;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Readex Pro', sans-serif;
        }
        .card {
            background-color: #fff;
            border-radius: 20px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            overflow: hidden;
            margin: 10px auto;
            padding: 15px;
            display: flex;
            flex-direction: column;
            align-items: center;
            width:650px;
        }
        .card-content {
            width: 100%;
        }

        .credit-input {
    width: 60px; /* Set a fixed width for the input */
    padding: 8px; /* Add some padding for better spacing */
    border: 1px solid #ccc; /* Light gray border */
    border-radius: 5px; /* Rounded corners */
    font-size: 14px; /* Font size */
    text-align: center; /* Center the text */
    transition: border-color 0.3s; /* Smooth transition for border color */
}

.credit-input:focus {
    border-color: #0098cb; /* Change border color on focus */
    outline: none; /* Remove default outline */
    box-shadow: 0 0 5px rgba(0, 152, 203, 0.5); /* Add a subtle shadow */
}
/* Hide the spinner for numeric input */
.credit-input::-webkit-inner-spin-button,
.credit-input::-webkit-outer-spin-button {
    -webkit-appearance: none; /* Remove default appearance */
    margin: 0; /* Remove margin */
}



        table {
            border-collapse: collapse;
            margin: 10px auto;
            width: 100%;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            border-radius: 8px;
            overflow: hidden;
        }
        th, td {
            border: 1px solid #f4f4f4;
            padding: 10px;
            text-align: center;
        }
        th {
            background-color: #7ed1ea;
            color: #000;
        }
        
 .grade-input {
    width: 45%; /* Full width */
    padding: 10px; /* Padding for better spacing */
    border: 1px solid #ccc; /* Light gray border */
    border-radius: 5px; /* Rounded corners */
    font-size: 14px; /* Font size */
    color: #333; /* Dark text color */
    background-color: #fff; /* White background */
    transition: border-color 0.3s, box-shadow 0.3s; /* Smooth transition for border color and shadow */
}

/* Change border color and add shadow on focus */
.grade-input:focus {
    border-color: #0098cb; /* Change border color on focus */
    outline: none; /* Remove default outline */
    box-shadow: 0 0 5px rgba(0, 152, 203, 0.5); /* Add a subtle shadow */
}

/* Style for the options in the dropdown */
.grade-input option {
    padding: 10px; /* Padding for options */
    background-color: #fff; /* White background for options */
    color: #333; /* Dark text color for options */
     
}

/* Hover effect for options */
.grade-input option:hover {
    background-color: #f0f0f0; /* Light gray background on hover */
}

/* Style for disabled state */
.grade-input:disabled {
    background-color: #f9f9f9; /* Light gray background for disabled */
    color: #aaa; /* Gray text for disabled */
    cursor: not-allowed; /* Change cursor to indicate disabled */
}
        
        .bttn {
            margin: 5px;
            padding: 8px 15px;
            font-size: 14px;
            cursor: pointer;
            border-color: #0098cb;
            border-radius: 5px;
            color: #000000;
            background-color:#7ed1ea;
        }
        .bton { margin: 5px;
            padding: 8px 15px;
            font-size: 14px;
            cursor: pointer;
            border-color: #4caf50;
            border-radius: 5px;
            color: #4caf50;
            background-color: #ffffff;
            
        }
        .bten {
            margin: 5px;
            padding: 8px 15px;
            font-size: 14px;
            cursor: pointer;
            border-color:#f44336;
            border-radius: 5px;
            color:#f44336;
            background-color:#ffffff;
        }
        .btun {
            margin: 5px;
            padding: 8px 15px;
            font-size: 14px;
            cursor: pointer;
            border-color:black;
            border-radius: 5px;
            color: #fff;
            background-color:#f44336;
        }
        .btn {
            margin: 5px;
            padding: 8px 15px;
            font-size: 14px;
            cursor: pointer;
            border-color:black;
            border-radius: 5px;
            color: #fff;
            background-color: #0098cb;
            text-align: center;
            margin-top: 15px;
        }
        .btn:hover {
            opacity: 0.8;
        }
        .button-container {
            text-align: center;
            margin-top: 15px;
        }
    </style>
</head>
<body>
    <header class="navbar">
        <div class="logo">Calculate Your GPA</div>
        <div class="nav-actions"></div>
        <a href="index.html" class="contact-link">Home</a>
    </header>

    <main>
        <br><div class="card">
            <div class="card-content">
                <h1 style="text-align: center;" class="card-title">Grade Point Average (GPA)</h1>
            </div>
        </div>
        <div class="button-container">
        <button class="bttn" onclick="customizeGrading()">Customize Grading</button></div>
        <div id="gradingContainer"></div>
        <div id="semesters"></div>
        <div class="button-container">
            <button class="btn" onclick="calculateCGPA()">Calculate CGPA</button>
            <button class="btn" style="background-color: #4caf50;" onclick="addSemester()">Add Semester</button>
            <button class="btun" id="removeSemesterBtn" style="display:none;" onclick="removeSemester()">Remove Semester</button>
            <button class="btn" onclick="GPAtoPercentage()">GPA to Percentage</button>
        </div>
        <br>
        <br>
        <div id="cgpaResults"></div>
            <div id="percentcontainer"></div>
    </main>
    <script src="Grading.js" defer></script>
    <script>
         let semesterCount = 1; // Start with one semester

// Render the first semester card on page load
renderSemester(semesterCount);

function addSemester() {
    semesterCount++;
    renderSemester(semesterCount);
    document.getElementById('removeSemesterBtn').style.display = 'inline'; // Show remove button
}

function renderSemester(semesterNumber) {
    const semestersDiv = document.getElementById('semesters');

    const semesterCard = document.createElement('div');
    semesterCard.className = 'card';
    semesterCard.id = `semesterCard${semesterNumber}`; // Unique ID for each semester card
    semesterCard.innerHTML = `
        <div class="card-content">
            <h3>Semester ${semesterNumber}</h3>
            <table>
               <thead>
                    <tr>
                        <th>Sr.No</th>
                        <th>Subject</th>
                        <th>Credit</th>
                        <th>Grade</th>
                    </tr>
                </thead>
                <tbody id="semester${semesterNumber}Body">
                    <tr>
                        <td contenteditable="true"  onkeydown="moveToNextField(event, this, 'subject1')">1</td>
                        <td contenteditable="true" id="subject1" onkeydown="moveToNextField(event, this, 'credit1')">Subject 1</td>
                        <td>
                           <input type="number" min="1" value="1" class="credit-input" id="credit1" onclick="this.select();" onkeydown="moveToNextField(event, this, 'grade1')">
                        </td>
                        <td>
                            <select class="grade-input" id="grade1">
                                <option value="10.0">O</option>
                                <option value="9.0">A</option>
                                <option value="8.0">B</option>
                                <option value="7.0">C</option>
                                <option value="6.0">D</option>
                                <option value="5.0">E</option>
                                <option value="4.0">P</option>
                                <option value="0.0">F</option>
                            </select>
                        </td>
                    </tr>
                    <tr>
                        <td contenteditable="true"  onkeydown="moveToNextField(event, this, 'subject2')">2</td>
                        <td contenteditable="true" id="subject2" onkeydown="moveToNextField(event, this, 'credit2')">Subject 2</td>
                        <td>
                           <input type="number" min="1" value="1" class="credit-input" id="credit2" onclick="this.select();" onkeydown="moveToNextField(event, this, 'grade2')">
                        </td>
                        <td>
                            <select class="grade-input" id="grade2">
                                <option value="10.0">O</option>
                                <option value="9.0">A</option>
                                <option value="8.0">B</option>
                                <option value="7.0">C</option>
                                <option value="6.0">D</option>
                                <option value="5.0">E</option>
                                <option value="4.0">P</option>
                                <option value="0.0">F</option>
                            </select>
                        </td>
                    </tr>
                    <tr>
                        <td contenteditable="true"  onkeydown="moveToNextField(event, this, 'subject3')">3</td>
                        <td contenteditable="true" id="subject3" onkeydown="moveToNextField(event, this, 'credit3')">Subject 3</td>
                        <td>
                            <input type="number" min="1" value="1" class="credit-input" id="credit3" onclick="this.select();" onkeydown="moveToNextField(event, this, 'grade3')">
                        </td>
                        <td>
                            <select class="grade-input" id="grade3">
                                <option value="10.0">O</option>
                                <option value="9.0">A</option>
                                <option value="8.0">B</option>
                                <option value="7.0">C</option>
                                <option value="6.0">D</option>
                                <option value="5.0">E</option>
                                <option value="4.0">P</option>
                                <option value="0.0">F</option>
                            </select>
                        </td>
                    </tr>
                </tbody>
            </table>
            <div class="button-container">
                <button class="btn" id="sgpaButton${semesterNumber}" onclick="calculateSGPA(${semesterNumber})">Calculate SGPA: 0.00</button>
                <button class="bton" onclick="addRow('semester${semesterNumber}Body', this)">Add</button>
                <button class="bten" style="display:none;" onclick="removeNewestRow('semester${semesterNumber}Body')">Remove</button>
            </div>
        </div>
    `;
    semestersDiv.appendChild(semesterCard);
}

function calculateCGPA() {
    let totalCredits = 0;
    let totalGradePoints = 0;
    let totalSemesters = semesterCount;

    for (let i = 1; i <= totalSemesters; i++) {
        const tbody = document.getElementById(`semester${i}Body`);
        const rows = tbody.getElementsByTagName('tr');

        for (let row of rows) {
            const credit = parseFloat(row.cells[2].querySelector('input').value); // Change from select to input
            const grade = parseFloat(row.cells[3].querySelector('select').value); // Grade remains a select

            if (!isNaN(credit) && !isNaN(grade)) {
                totalCredits += credit;
                totalGradePoints += credit * grade;
            }
        }
    }

    const cgpa = totalCredits > 0 ? (totalGradePoints / totalCredits).toFixed(2) : '0.00';

    // Create a new card to display the CGPA results
    displayCGPAResults(totalSemesters, totalCredits, totalGradePoints, cgpa);
}

function displayCGPAResults(totalSemesters, totalCredits, totalGradePoints, cgpa) {
    const resultsDiv = document.getElementById('cgpaResults');
    resultsDiv.innerHTML = ''; // Clear previous results

    const cgpaCard = document.createElement('div');
    cgpaCard.className = 'card';
    cgpaCard.innerHTML = `
        <div class="card-content">
            <h3>CGPA Calculation Results</h3>
            <table>
                <thead>
                    <tr>
                        <th>Total Semesters</th>
                        <th>Total Credits</th>
                        <th>Total Earned GP</th>
                        <th>CGPA</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>${totalSemesters}</td>
                        <td>${totalCredits}</td>
                        <td>${totalGradePoints.toFixed(2)}</td>
                        <td>${cgpa}</td>
                    </tr>
                </tbody>
            </table>
        </div>
    `;
    resultsDiv.appendChild(cgpaCard);
}

function calculateSGPA(semesterNumber) {
    const tbody = document.getElementById(`semester${semesterNumber}Body`);
    const rows = tbody.getElementsByTagName('tr');

    let totalCredits = 0;
    let totalGradePoints = 0;

    for (let row of rows) {
        const credit = parseFloat(row.cells[2].querySelector('input').value); // Change from select to input
        const grade = parseFloat(row.cells[3].querySelector('select').value); // Grade remains a select

        if (isNaN(credit) || isNaN(grade)) {
            alert('Please fill in all credit and grade fields correctly.');
            return;
        }

        totalCredits += credit;
        totalGradePoints += credit * grade;
    }

    const sgpa = totalCredits > 0 ? (totalGradePoints / totalCredits).toFixed(2) : '0.00';
    
    // Update the button text to show the calculated SGPA
    const sgpaButton = document.getElementById(`sgpaButton${semesterNumber}`);
    sgpaButton.innerText = `Calculate SGPA: ${sgpa}`;
}

function addRow(semesterBodyId, addRowButton) {
    const tbody = document.getElementById(semesterBodyId); 
    const rows = tbody.getElementsByTagName('tr'); 

    const newRowIndex = rows.length + 1; 
    const newRow = document.createElement('tr');
    newRow.innerHTML = `
        <td contenteditable="true" onkeydown="moveToNextField(event, this, 'subject${newRowIndex}')">${newRowIndex}</td>
        <td contenteditable="true" id="subject${newRowIndex}" onkeydown="moveToNextField(event, this, 'credit${newRowIndex}')">Subject ${newRowIndex}</td>
        <td>
           <input type="number" min="1" value="1" class="credit-input" id="credit${newRowIndex}" onclick="this.select();" onkeydown="moveToNextField(event, this, 'grade${newRowIndex}')">
        </td>
        <td>
            <select class="grade-input" id="grade${newRowIndex}">
                <option value="10.0">O</option>
                <option value="9.0">A</option>
                <option value="8.0">B</option>
                <option value="7.0">C</option>
                <option value="6.0">D</option>
                <option value="5.0">E</option>
                <option value="4.0">P</option>
                <option value="0.0">F</option>
            </select>
        </td>
    `;

    tbody.appendChild(newRow);

    

    const removeRowButton = addRowButton.parentElement.querySelector('.button-container button:last-child');
    if (rows.length > 3) {
        removeRowButton.style.display = 'inline-block';
    }
}

function moveToNextField(event, currentField, nextFieldId) {
    if (event.key === 'Enter') {
        event.preventDefault(); // Prevent the default action (e.g., form submission)
        const nextField = document.getElementById(nextFieldId);
        if (nextField) {
            nextField.focus(); // Move focus to the next field
        }
    }
}

function removeNewestRow(semesterBodyId) {
    const tbody = document.getElementById(semesterBodyId); 
    const rows = tbody.getElementsByTagName('tr'); 

    if (rows.length > 3) { 
        tbody.removeChild(rows[rows.length - 1]); 
    }

    if (rows.length === 3) {
    // Locate the "Remove Row" button in the same card
    const cardElement = tbody.closest('.card'); // Closest card container
    const removeRowButton = cardElement.querySelector('.button-container button:last-child'); // Locate the button
    removeRowButton.style.display = 'none'; // Hide the button
}
}

function removeSemester() {
    if (semesterCount > 1) {
        const semesterCard = document.getElementById(`semesterCard${semesterCount}`);
        semesterCard.parentElement.removeChild(semesterCard); 
        semesterCount--; 
    }
    if (semesterCount === 1) {
        document.getElementById('removeSemesterBtn').style.display = 'none'; 
    }
}

function GPAtoPercentage() {
    const totalSemesters = semesterCount; // Get the total number of semesters
    let totalCGPA = 0;
    let totalCredits = 0;

    // Calculate total CGPA and total credits
    for (let i = 1; i <= totalSemesters; i++) {
        const tbody = document.getElementById(`semester${i}Body`);
        const rows = tbody.getElementsByTagName('tr');

        for (let row of rows) {
            const credit = parseFloat(row.cells[2].querySelector('input').value);
            const grade = parseFloat(row.cells[3].querySelector('select').value);

            if (!isNaN(credit) && !isNaN(grade)) {
                totalCredits += credit;
                totalCGPA += credit * grade; // Calculate total grade points for CGPA
            }
        }
    }

    const cgpa = totalCredits > 0 ? (totalCGPA / totalCredits).toFixed(2) : '0.00';

    // Calculate percentage based on CGPA
    const cgpaPercentage = calculatePercentage(cgpa);

    // Determine the type to display
    const typeToDisplay = totalSemesters === 1 ? 'SGPA' : 'CGPA';

    // Display results in a card
    displayPercentageResults(typeToDisplay, cgpa, cgpaPercentage);
}

function calculatePercentage(cgpa) {
    const cgpaValue = parseFloat(cgpa);
    if (cgpaValue < 7) {
        return (7.1 * cgpaValue + 12).toFixed(2); // Formula for CGPA < 7
    } else {
        return (7.4 * cgpaValue + 12).toFixed(2); // Formula for CGPA >= 7
    }
}

function displayPercentageResults(type, gpa, gpaPercentage) {
    const resultsDiv = document.getElementById('percentcontainer');
    resultsDiv.innerHTML = ''; // Clear previous results

    const percentageCard = document.createElement('div');
    percentageCard.className = 'card';
    percentageCard.innerHTML = `
        <div class="card-content">
            <h3>${type} to Percentage Conversion</h3>
            <table>
                <thead>
                    <tr>
                        <th>Type</th>
                        <th>Value</th>
                        <th>Percentage</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>${type}</td>
                        <td>${gpa}</td>
                        <td>${gpaPercentage}</td>
                    </tr>
                </tbody>
            </table>
        </div>
    `;
    resultsDiv.appendChild(percentageCard);
}
    </script>
</body>
</html>

